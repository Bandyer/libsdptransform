# Grammar

Here the syntax of the JSON object generated by `sdptransform::parse(sdp)`. Each section below defines how the corresponding SDP line is parsed.

Some lines are parsed as a JSON object with different fields, while others have a JSON string, JSON integer or JSON float as value.

* The name of each subsection below corresponds to the `key` string in the JSON object (or the corresponding `media` section).
* `multiple` flag means that, if at least one of those lines exists in the SDP, its value is a JSON array with multiple values (for eample, the `a=rtpmap` line).
* `type` field indicates the C++ valid conversion for the parsed value or values.


### version

`v=0`

* type: string 
* example: 0


### origin

`o=- 20518 0 IN IP4 203.0.113.1`

* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| username        | string  | yes       | "-"
| sessionId       | integer | yes       | 20518
| sessionVersion  | integer | yes       | 0
| netType         | string  | yes       | "IN"
| ipVer           | integer | yes       | 4
| adddress        | string  | yes       | "203.0.113.1"


### name

`s=-`

* type: string 
* example: "-"


### description

`i=foo`

* type: string 
* example: "foo"


### uri

`u=https://foo.com`

* type: string 
* example: "https://foo.com"


### email

`e=alice@foo.com`

* type: string 
* example: "alice@foo.com"


### phone

`p=+12345678`

* type: string 
* example: "+12345678"


### timing

`t=0 0`

* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| start           | integer | yes       | 0
| stop            | integer | yes       | 0


### connection

`c=IN IP4 10.47.197.26`

* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| version         | integer | yes       | 4
| ip              | string  | yes       | "10.47.197.26"


### bandwidth

`b=AS:4000`

* multiple
* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| type            | string  | yes       | "AS"
| limit           | integer | yes       | 4000


### media

`m=video 51744 RTP/AVP 126 97 98 34 31`

* multiple
* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| type            | string  | yes       | "video"
| port            | integer | yes       | 51744
| protocol        | string  | yes       | "RTP/AVP"
| payloads        | string  | no        | "126 97 98 34 31"


### rtp

`a=rtpmap:110 opus/48000/2`

* multiple
* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| payload         | integer | yes       | 110
| codec           | string  | yes       | "opus"
| rate            | integer | no        | 48000
| encoding        | string  | no       | "2"


### fmtp

`a=fmtp:108 profile-level-id=24;bitrate=64000`

`a=fmtp:111 minptime=10; useinbandfec=1`

* multiple
* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| payload         | integer | yes       | 108
| config          | string  | yes       | "profile-level-id=24;bitrate=64000"


### control

`a=control:streamid=0`

* type: string 
* example: "streamid=0"


### rtcp

`a=rtcp:65179 IN IP4 193.84.77.194`

* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| port            | integer | yes       | 65179
| netType         | string  | yes       | "IN"
| ipVer           | integer | yes       | 4
| adddress        | string  | yes       | "193.84.77.194"


### rtcpFbTrrInt

`a=rtcp-fb:98 trr-int 100`

* multiple
* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| payload         | string  | yes       | "98" (could be "*")
| value           | integer | yes       | 100


### rtcpFb

`a=rtcp-fb:98 nack rpsi`

* multiple
* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| payload         | string  | yes       | "98" (could be "*")
| type            | string  | yes       | "nack"
| subtype         | string  | no        | "rpsi"


### ext

`a=extmap:1/recvonly URI-gps-string`

`a=extmap:2 urn:ietf:params:rtp-hdrext:toffset`

* multiple
* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| value           | integer | yes       | 1
| direction       | string  | no        | "recvonly"
| uri             | string  | yes       | "URI-gps-string"
| config          | string  | no        |


### crypto

`a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:PS1uQCVeeCFCanVmcjkpPywjNWhcYD0mXXtxaVBR|2^20|1:32`

* multiple
* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| id              | integer | yes       | 1
| suite           | string  | yes       | "AES_CM_128_HMAC_SHA1_80"
| config          | string  | yes       | "inline:PS1uQCVeeCFCanVmcjkpPywjNWhcYD0mXXtxaVBR|2^20|1:32"
| sessionConfig    | string  | no       |


### setup

`a=setup:actpass`

* type: string 
* example: "actpass"


### mid

`a=mid:audio`

* type: string 
* example: "audio"


### msid

`a=msid:0c8b064d-d807-43b4 46e0-8e16-7ef0db0db64a`

* type: string 
* example: "0c8b064d-d807-43b4 46e0-8e16-7ef0db0db64a"


### ptime

`a=ptime:20`

* type: integer 
* example: 20


### maxptime

`a=maxptime:60`

* type: integer 
* example: 60


### direction

`a=sendrecv`

* type: string 
* example: "sendrecv"


### icelite

`a=ice-lite`

* type: string 
* example: "ice-lite"


### iceUfrag

`a=ice-ufrag:F7gI`

* type: string 
* example: "F7gI"


### icePwd

`a=ice-pwd:x9cml/YzichV2+XlhiMu8g`

* type: string 
* example: "x9cml/YzichV2+XlhiMu8g"


### fingerprint

`a=fingerprint:SHA-1 00:11:22:33:44:55:66:77:88:99:AA:BB:CC:DD:EE:FF:00:11:22:33`

* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| type            | string  | yes       | "SHA-1"
| hash            | string  | yes       | "00:11:22:33:44:55:66:77:88:99:AA:BB:CC:DD:EE:FF:00:11:22:33"


### candidates

`a=candidate:0 1 UDP 2113667327 203.0.113.1 54400 typ host`

`a=candidate:1162875081 1 udp 2113937151 192.168.34.75 60017 typ host generation 0 network-id 3 network-cost 10`

`a=candidate:3289912957 2 udp 1845501695 193.84.77.194 60017 typ srflx raddr 192.168.34.75 rport 60017 generation 0 network-id 3 network-cost 10`

`a=candidate:229815620 1 tcp 1518280447 192.168.150.19 60017 typ host tcptype active generation 0 network-id 3 network-cost 10`

`a=candidate:3289912957 2 tcp 1845501695 193.84.77.194 60017 typ srflx raddr 192.168.34.75 rport 60017 tcptype passive generation 0 network-id 3 network-cost 10`

* multiple
* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| foundation      | string  | yes       | "3289912957"
| component       | integer | yes       | 2
| transport       | string  | yes       | "tcp"
| priority        | integer | yes       | 1845501695
| ip              | string  | yes       | "193.84.77.194"
| port            | integer | yes       | 60017
| type            | string  | yes       | "srflx"
| raddr           | string  | no        | "192.168.34.75"
| rport           | integer | no        | 60017
| generation      | integer | no        | 0
| network-id      | integer | no        | 3
| network-cost    | integer | no        | 10


### endOfCandidates

`a=end-of-candidates`

* type: string 
* example: "end-of-candidates"


### remoteCandidates

`a=remote-candidates:1 203.0.113.1 54400 2 203.0.113.1 54401`

* type: string 
* example: "1 203.0.113.1 54400 2 203.0.113.1 54401"


### iceOptions

`a=ice-options:google-ice`

* type: string 
* example: "google-ice"


### ssrcs

`a=ssrc:2566107569 cname:t9YU8M1UxTF8Y1A1`

* multiple
* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| id              | integer | yes       | 2566107569
| attribute       | string  | yes       | "cname"
| value           | string  | no        | "t9YU8M1UxTF8Y1A1"


### ssrcGroups

`a=ssrc-group:FEC-FR 3004364195 1080772241`

* multiple
* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| semantics       | string  | yes       | "FEC-FR"
| ssrcs           | string  | no        | "3004364195 1080772241"


### msidSemantic

`a=msid-semantic: WMS Jvlam5X3SX1OP6pn20zWogvaKJz5Hjf9OnlV`

* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| semantic        | string  | yes       | "WMS"
| token           | string  | no        | "Jvlam5X3SX1OP6pn20zWogvaKJz5Hjf9OnlV"


### groups

`a=group:BUNDLE audio video`

* multiple
* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| type            | string  | yes       | "BUNDLE"
| mids            | string  | no        | "audio video"


### rtcpMux

`a=rtcp-mux`

* type: string 
* example: "rtcp-mux"


### rtcpRsize

`a=rtcp-rsize`

* type: string 
* example: "rtcp-rsize"


### sctpmap

`a=sctpmap:5000 webrtc-datachannel 1024`

* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| sctpmapNumber   | integer | yes       | 5000
| app             | string  | no        | "webrtc-datachannel"
| maxMessageSize  | integer | no        | 1024


### xGoogleFlag

`a=x-google-flag:conference`

* type: string 
* example: "conference"


### rids

`a=rid:1 send max-width=1280;max-height=720`

* multiple
* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| id              | string  | yes       | "1"
| direction       | string  | yes       | "send"
| params          | string  | no        | "max-width=1280;max-height=720"


### imageattrs

`a=imageattr:97 send [x=800,y=640,sar=1.1,q=0.6] [x=480,y=320] recv [x=330,y=250]`

`a=imageattr:* send [x=800,y=640] recv *`

`a=imageattr:100 recv [x=320,y=240]`

* multiple
* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| pt              | string  | yes       | "97" (could be "*")
| dir1            | string  | yes       | "send"
| attrs1          | string  | no        | "[x=800,y=640,sar=1.1,q=0.6] [x=480,y=320]"
| dir2            | string  | no        | "recv"
| attrs2          | string  | no        | "[x=330,y=250]"


### simulcast

`a=simulcast:send 1,2,3;~4,~5 recv 6;~7,~8`

`a=simulcast:recv 1;4,5 send 6;7`

* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| dir1            | string  | yes       | "send"
| list1           | string  | yes       | "1,2,3;~4,~5"
| dir2            | string  | no        | "recv"
| list2           | string  | no        | "6;~7,~8"


### simulcast_03

Old simulcast draft [revision 03](https://tools.ietf.org/html/draft-ietf-mmusic-sdp-simulcast-03) (implemented by some browsers).

`a=simulcast: recv pt=97;98 send pt=97`

`a=simulcast: send rid=5;6;7 paused=6,7`

* type: string
* example: "recv pt=97;98 send pt=97"


### framerate

`a=framerate:25`

`a=framerate:29.97`

* type: float
* example: "25.0"


### invalid

Unknown SDP lines are stored within the `invalid` key.

* multiple
* type: object

| field           | type    | mandatory | example
| --------------- | ------- | --------- | -------------------------
| value           | string  | no        |
